webpackHotUpdate(0,{

/***/ "./src/common/mapVisual/init.js":
/*!**************************************!*\
  !*** ./src/common/mapVisual/init.js ***!
  \**************************************/
/*! exports provided: map, stats, swipeLayer, threeLayer, threeCustomLayer, initMapVisual, initPlugins */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"map\", function() { return map; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"stats\", function() { return stats; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"swipeLayer\", function() { return swipeLayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"threeLayer\", function() { return threeLayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"threeCustomLayer\", function() { return threeCustomLayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initMapVisual\", function() { return initMapVisual; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initPlugins\", function() { return initPlugins; });\n/* harmony import */ var maptalks__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! maptalks */ \"./node_modules/_maptalks@1.0.0-alpha.15@maptalks/dist/maptalks.es.js\");\n/* harmony import */ var three__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! three */ \"./node_modules/_three@0.125.2@three/build/three.module.js\");\n/* harmony import */ var maptalks_three__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! maptalks.three */ \"./node_modules/_maptalks.three@0.13.4@maptalks.three/dist/maptalks.three.es.js\");\n/* harmony import */ var _config_map_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config/map.config */ \"./src/common/mapVisual/config/map.config.js\");\n/* harmony import */ var _config_baseLayer_config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config/baseLayer.config */ \"./src/common/mapVisual/config/baseLayer.config.js\");\n/* harmony import */ var _tools__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./tools */ \"./src/common/mapVisual/tools/index.js\");\n/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./api */ \"./src/common/mapVisual/api/index.js\");\n/* harmony import */ var maptalks_dist_maptalks_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! maptalks/dist/maptalks.css */ \"./node_modules/_maptalks@1.0.0-alpha.15@maptalks/dist/maptalks.css\");\n/* harmony import */ var maptalks_dist_maptalks_css__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(maptalks_dist_maptalks_css__WEBPACK_IMPORTED_MODULE_7__);\n/*\r\n * @Descripttion: map初始化方法\r\n * @Author: wxc\r\n * @Date: 2021-01-29 08:43:19\r\n * @LastEditTime: 2021-02-20 23:07:08\r\n */\r\n\r\n\r\n\r\n\r\n\r\n// import variableConfig from \"./config/variable.config\";\r\n\r\n\r\n// import { mapApi } from \"./api\";\r\n\r\n// import { mapJSON } from \"../../data/pipe/drainpipe\";\r\n\r\n\r\n\r\nconst {\r\n  center,\r\n  zoom,\r\n  pitch,\r\n  minZoom,\r\n  maxZoom,\r\n  bearing,\r\n  fog,\r\n  spatialReference,\r\n  resolutions\r\n} = _config_map_config__WEBPACK_IMPORTED_MODULE_3__[\"default\"].Map;\r\n\r\nlet\r\n  map, // 地图实例\r\n  stats, // stats实例\r\n  swipeLayer, // 卷帘图层\r\n  threeLayer,\r\n  threeCustomLayer;\r\n\r\n// 初始化地图\r\nconst initMapVisual = () => {\r\n  const _baseLayerConfig = Object.values(_config_baseLayer_config__WEBPACK_IMPORTED_MODULE_4__[\"baseLayerConfig\"])\r\n    .reduce((prev, item) => [...prev, ...item.layers], []);\r\n\r\n  map = new maptalks__WEBPACK_IMPORTED_MODULE_0__[\"Map\"](\"map\", {\r\n    center: center,\r\n    zoom: zoom,\r\n    pitch: pitch, // 俯仰角\r\n    minZoom: minZoom, // 最小缩放比例\r\n    maxZoom: maxZoom, // 最大缩放比例\r\n    bearing: bearing, // 方位\r\n    fog: fog,\r\n    centerCross: false,\r\n    doubleClickZoom: false, // 双击缩放,\r\n    seamlessZoom: true, // 是否使用无缝缩放模式\r\n    attribution: false,\r\n    spatialReference: {\r\n      projection: spatialReference,\r\n      resolutions: resolutions\r\n    },\r\n    layers: _baseLayerConfig,\r\n  });\r\n\r\n  _api__WEBPACK_IMPORTED_MODULE_6__[\"layerApi\"].showLayerByGroupName(\"暗黑图\");\r\n  swipeLayer = map.getLayer(\"天地图地形图\");\r\n  // maptalks.Map.fromJSON(\"map\", mapJSON);\r\n\r\n  // three\r\n  threeLayer = new maptalks_three__WEBPACK_IMPORTED_MODULE_2__[\"ThreeLayer\"](\"ThreeLayer\", {\r\n    forceRenderOnMoving: true,\r\n    forceRenderOnRotating: true,\r\n    forceRenderOnZooming: true,\r\n    animation: true\r\n  });\r\n\r\n  threeCustomLayer = new maptalks_three__WEBPACK_IMPORTED_MODULE_2__[\"ThreeLayer\"](\"ThreeCustomLayer\", {\r\n    forceRenderOnMoving: true,\r\n    forceRenderOnRotating: true,\r\n    forceRenderOnZooming: true,\r\n    animation: true\r\n  });\r\n\r\n  threeLayer.addTo(map);\r\n  threeCustomLayer.addTo(map);\r\n\r\n  threeCustomLayer.prepareToDraw = function(gl, scene, camera) {\r\n    const light = new three__WEBPACK_IMPORTED_MODULE_1__[\"DirectionalLight\"](0xffffff);\r\n    light.position.set(0, -10, 10).normalize();\r\n\r\n    scene.add(light);\r\n    scene.add(new three__WEBPACK_IMPORTED_MODULE_1__[\"AmbientLight\"](0xffffff));\r\n  };\r\n\r\n  threeLayer.prepareToDraw = function(gl, scene, camera) {\r\n    stats = _tools__WEBPACK_IMPORTED_MODULE_5__[\"mapTool\"].setStats(); // 显示帧数和渲染时间\r\n    const light = new three__WEBPACK_IMPORTED_MODULE_1__[\"DirectionalLight\"](0xffffff);\r\n    light.position.set(0, -10, 10).normalize();\r\n\r\n    scene.add(light);\r\n    scene.add(new three__WEBPACK_IMPORTED_MODULE_1__[\"AmbientLight\"](0xffffff));\r\n\r\n    // loadAllLayer();    //加载所有可视化图层\r\n\r\n    // mapApi.mapInitAnimation();\r\n    animation(); //帧循环\r\n  };\r\n\r\n  return map;\r\n};\r\n\r\n// 地图初始进入动画效果\r\nconst animation = () => {\r\n  threeLayer._needsUpdate = !threeLayer._needsUpdate;\r\n  if (threeLayer._needsUpdate) {\r\n    threeLayer._renderer.clearCanvas();\r\n    threeLayer.renderScene();\r\n  }\r\n\r\n  threeCustomLayer._needsUpdate = !threeCustomLayer._needsUpdate;\r\n  if (threeCustomLayer._needsUpdate) {\r\n    threeCustomLayer._renderer.clearCanvas();\r\n    threeCustomLayer.renderScene();\r\n  }\r\n\r\n  stats.update();\r\n  requestAnimationFrame(animation);\r\n};\r\n\r\n// 初始化插件\r\nconst initPlugins = () => {\r\n  _tools__WEBPACK_IMPORTED_MODULE_5__[\"mapTool\"].setScaleBar(); // 比例尺\r\n  _tools__WEBPACK_IMPORTED_MODULE_5__[\"mapTool\"].setZoomBar(); // 缩放控件\r\n  _tools__WEBPACK_IMPORTED_MODULE_5__[\"mapTool\"].setCompass(); // 指北针\r\n};\r\n\r\n\n\n//# sourceURL=webpack:///./src/common/mapVisual/init.js?");

/***/ })

})